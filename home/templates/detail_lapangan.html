{% extends 'base.html' %}
{% load static %}

{% block content %}
  <div class="container mt-5 mb-5">
    <div class="court-detail-card p-4 shadow-sm rounded bg-white">
      <h2 class="text-center mb-4 fw-bold">{{ lapangan.nama }}</h2>

      <div class="row g-4">
        <!-- Left: Image and Description -->
        <div class="col-md-7">
          <img src="{{ lapangan.thumbnail_url|default:'https://via.placeholder.com/600x350.png?text=No+Image' }}" class="img-fluid rounded mb-3" alt="{{ lapangan.nama }}" />

          <h5 class="fw-bold text-danger">Price</h5>
          <p>275k/hour</p>

          <div class="d-flex align-items-center mb-2">
            {% if lapangan.rating %}
              <div class="text-warning fs-5">
                {% for i in '12345'|slice:':5' %}
                  {% if forloop.counter <= lapangan.rating|floatformat:0 %}
                    ★
                  {% else %}
                    ☆
                  {% endif %}
                {% endfor %}
              </div>
              <span class="ms-2 text-muted">({{ lapangan.total_review|default:'0' }} reviews)</span>
            {% else %}
              <span class="text-muted">No rating yet</span>
            {% endif %}
          </div>

          <h5 class="fw-bold text-danger">Description</h5>
          <p>{{ lapangan.notes|default:'Lapangan padel ini memiliki fasilitas lengkap dan lokasi strategis.' }}</p>

          <div class="mt-3 d-flex gap-3">
            <a href="{% url 'home:home' %}" class="btn btn-secondary">Back</a>
            <a href="#" class="btn btn-success">Booking</a>
          </div>
        </div>

        <!-- Right: Info -->
        <div class="col-md-5">
          <div class="p-3 rounded bg-light mb-3">
            <h5 class="fw-bold mb-2">Facility</h5>
            <ul class="list-unstyled mb-0">
              <li>• Shower</li>
              <li>• Wi-Fi</li>
              <li>• Parking area</li>
              <li>• Locker</li>
              <li>• Seating area</li>
            </ul>
          </div>

          <div class="p-3 rounded bg-light mb-3">
            <h5 class="fw-bold mb-2">Address</h5>
            <p class="mb-1">{{ lapangan.alamat }}</p>
          </div>

          <div class="p-3 rounded bg-light">
            <h5 class="fw-bold mb-2">Contact</h5>
            <p class="mb-1">+62 812-3456-7890</p>
            <p>info@propadel.id</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Reviews Section -->
    <div class="mt-5">
      <h4 class="fw-bold text-center mb-4 text-danger">What they say?</h4>

      {% if reviews %}
        <div id="reviewCarousel" class="carousel slide" data-bs-ride="carousel">
          <div class="carousel-inner">
            {% for r in reviews %}
              <div class="carousel-item {% if forloop.first %}active{% endif %}">
                <div class="review-card mx-auto p-4 bg-light rounded shadow-sm text-center" style="max-width:600px;">
                  <div class="mb-3">
                    <div class="rounded-circle bg-secondary mx-auto" style="width:60px;height:60px;"></div>
                    <h6 class="mt-2">{{ r.display_username }}</h6>
                  </div>
                  <p class="text-muted small">⭐ {{ r.rating }}/5</p>
                  <p class="mb-2">“{{ r.comment }}”</p>
                  <p class="text-muted small">reviewed at {{ r.created_at|date:'d M Y, H:i' }}</p>
                </div>
              </div>
            {% endfor %}
          </div>
          <button class="carousel-control-prev" type="button" data-bs-target="#reviewCarousel" data-bs-slide="prev"><span class="carousel-control-prev-icon"></span></button>
          <button class="carousel-control-next" type="button" data-bs-target="#reviewCarousel" data-bs-slide="next"><span class="carousel-control-next-icon"></span></button>
        </div>
        <div class="text-center mt-3">
          <a href="{% url 'review:all_reviews' lapangan.id %}" class="text-decoration-none">See all customer reviews</a>
        </div>
      {% else %}
        <p class="text-center text-muted">No reviews yet.</p>
      {% endif %}
    </div>
  </div>

  <style>
    .court-detail-card {
      border-radius: 16px;
    }
    
    .review-card {
      border: 1px solid #ddd;
    }
    
    .carousel-control-prev-icon,
    .carousel-control-next-icon {
      background-color: #000;
      border-radius: 50%;
    }
  </style>
{% endblock %}
