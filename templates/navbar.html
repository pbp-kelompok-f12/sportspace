{% load static %}
<nav class="w-full sticky top-0 z-50 bg-white/90 backdrop-blur-md shadow-sm border-b border-gray-100">
  <div class="flex items-center justify-between px-4 sm:px-8 py-3">

    <!-- Logo -->
    <div class="flex items-center gap-3 flex-none">
      <img src="{% static 'img/logoonly.png' %}" alt="SportSpace" class="h-8 w-8 rounded-md shadow-sm">
      <a href="/" class="text-[#0C2D57] font-extrabold text-xl tracking-tight hover:text-orange-500 transition">SportSpace</a>
    </div>

    <!-- Menu Desktop -->
    <ul class="hidden md:flex flex-1 justify-center gap-8 text-[#0C2D57] font-semibold items-center">
      {% if user.is_authenticated %}
        {% if user.profile.role == 'admin' %}
          <li>
            <a href="/dashboard-admin/"
               class="px-4 py-2 rounded-full transition-all duration-200 hover:bg-orange-100 hover:text-orange-600 {% if request.path == '/dashboard-admin/' %}bg-orange-500 text-white shadow-sm{% endif %}">
               Dashboard
            </a>
          </li>
          <li>
            <a href="/dashboard-admin/lapangan/"
               class="px-4 py-2 rounded-full transition-all duration-200 hover:bg-orange-100 hover:text-orange-600 {% if '/dashboard-admin/lapangan/' in request.path %}bg-orange-500 text-white shadow-sm{% endif %}">
               Lapangan
            </a>
          </li>
          <li>
            <a href="/dashboard-admin/users/"
               class="px-4 py-2 rounded-full transition-all duration-200 hover:bg-orange-100 hover:text-orange-600 {% if '/dashboard-admin/users/' in request.path %}bg-orange-500 text-white shadow-sm{% endif %}">
               Pengguna
            </a>
          </li>
          <li>
            <a href="/dashboard-admin/bookings/"
               class="px-4 py-2 rounded-full transition-all duration-200 hover:bg-orange-100 hover:text-orange-600 {% if '/dashboard-admin/bookings/' in request.path %}bg-orange-500 text-white shadow-sm{% endif %}">
               Booking
            </a>
          </li>
        {% else %}
          <li>
            <a href="/home/"
               class="px-4 py-2 rounded-full transition-all duration-200 hover:bg-orange-100 hover:text-orange-600 {% if request.path == '/home/' %}bg-orange-500 text-white shadow-sm{% endif %}">
               Sewa Lapangan
            </a>
          </li>
          <li>
            <a href="/booking/my-bookings/"
               class="px-4 py-2 rounded-full transition-all duration-200 hover:bg-orange-100 hover:text-orange-600 {% if '/booking/my-bookings/' in request.path %}bg-orange-500 text-white shadow-sm{% endif %}">
               Booking Saya
            </a>
          </li>
          <li>
            <a href="/matchmaking/"
               class="px-4 py-2 rounded-full transition-all duration-200 hover:bg-orange-100 hover:text-orange-600 {% if '/matchmaking/' in request.path %}bg-orange-500 text-white shadow-sm{% endif %}">
               Matchmaking
            </a>
          </li>
          <li>
            <a href="{% url 'review:my_reviews' %}"
               class="px-4 py-2 rounded-full transition-all duration-200 hover:bg-orange-100 hover:text-orange-600 {% if '/review/my/' in request.path %}bg-orange-500 text-white shadow-sm{% endif %}">
               My Reviews
            </a>
          </li>
        {% endif %}
      {% else %}
        <li>
          <a href="/home/"
             class="px-4 py-2 rounded-full transition-all duration-200 hover:bg-orange-100 hover:text-orange-600 {% if request.path == '/home/' %}bg-orange-500 text-white shadow-sm{% endif %}">
             Home
          </a>
        </li>
      {% endif %}
    </ul>

    <!-- Profile / Auth -->
    <div class="hidden md:flex items-center gap-4">
      {% if user.is_authenticated %}
        <a href="/accounts/profile/" class="flex items-center gap-2 hover:bg-[#0C2D57]/10 px-2 py-1 rounded-lg transition">
          {% if user.profile.photo_url %}
            <img src="{{ user.profile.photo_url }}" class="h-8 w-8 rounded-full object-cover border border-[#0C2D57]/20">
          {% else %}
            <img src="{% static 'img/defaultprofile.png' %}" class="h-8 w-8 rounded-full object-cover border border-[#0C2D57]/20">
          {% endif %}
          <span class="font-medium text-[#0C2D57]">{{ user.username }}</span>
        </a>
        <form action="/accounts/logout/" method="post" class="m-0">
          {% csrf_token %}
          <button class="bg-[#0C2D57] hover:bg-[#163970] px-4 py-1.5 text-white font-semibold rounded-lg shadow-sm transition">Log Out</button>
        </form>
      {% else %}
        <a href="/login/" class="bg-[#0C2D57] hover:bg-[#163970] px-4 py-1.5 text-white font-semibold rounded-lg shadow-sm transition">Log In</a>
      {% endif %}
    </div>

    <!-- Mobile Toggle -->
    <button id="navbar-toggle" class="md:hidden text-[#0C2D57] focus:outline-none hover:scale-110 transition" aria-label="Open menu">
      <svg class="w-7 h-7" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" d="M4 7h16M4 12h16M4 17h16"/>
      </svg>
    </button>
  </div>

  <!-- MOBILE NAV -->
  <div id="mobile-nav"
    class="fixed inset-0 bg-white/95 backdrop-blur-md md:hidden z-[101] flex flex-col transform -translate-y-full opacity-0 pointer-events-none transition-all duration-300">
    <div class="flex items-center px-5 pt-5 pb-3 border-b border-gray-200">
      <img src="{% static 'img/logoonly.png' %}" class="h-9 w-9 rounded-md">
      <a href="/" class="text-[#0C2D57] font-bold text-xl ml-2">SportSpace</a>
      <button id="mobile-nav-close" class="ml-auto p-2 text-[#0C2D57] hover:bg-gray-100 rounded-full transition" aria-label="Close menu">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"/>
        </svg>
      </button>
    </div>

    <ul class="flex flex-col text-base px-6 pb-4 overflow-y-auto">
      {% if user.is_authenticated %}
        {% if user.profile.role == 'admin' %}
          <li><a href="/dashboard-admin/" class="block py-3 px-4 rounded-full hover:bg-orange-100 hover:text-orange-600 {% if request.path == '/dashboard-admin/' %}bg-orange-500 text-white{% endif %}">Dashboard Utama</a></li>
          <li><a href="/dashboard-admin/lapangan/" class="block py-3 px-4 rounded-full hover:bg-orange-100 hover:text-orange-600 {% if '/dashboard-admin/lapangan/' in request.path %}bg-orange-500 text-white{% endif %}">Lapangan</a></li>
          <li><a href="/dashboard-admin/users/" class="block py-3 px-4 rounded-full hover:bg-orange-100 hover:text-orange-600 {% if '/dashboard-admin/users/' in request.path %}bg-orange-500 text-white{% endif %}">Pengguna</a></li>
          <li><a href="/dashboard-admin/bookings/" class="block py-3 px-4 rounded-full hover:bg-orange-100 hover:text-orange-600 {% if '/dashboard-admin/bookings/' in request.path %}bg-orange-500 text-white{% endif %}">Booking</a></li>
        {% else %}
          <li><a href="/home/" class="block py-3 px-4 rounded-full hover:bg-orange-100 hover:text-orange-600 {% if request.path == '/home/' %}bg-orange-500 text-white{% endif %}">Sewa Lapangan</a></li>
          <li><a href="/booking/my-bookings/" class="block py-3 px-4 rounded-full hover:bg-orange-100 hover:text-orange-600 {% if '/booking/my-bookings/' in request.path %}bg-orange-500 text-white{% endif %}">Bookingan Saya</a></li>
          <li><a href="/matchmaking/" class="block py-3 px-4 rounded-full hover:bg-orange-100 hover:text-orange-600 {% if '/matchmaking/' in request.path %}bg-orange-500 text-white{% endif %}">Matchmaking</a></li>
          <li><a href="{% url 'review:my_reviews' %}" class="block py-3 px-4 rounded-full hover:bg-orange-100 hover:text-orange-600 {% if '/review/my/' in request.path %}bg-orange-500 text-white{% endif %}">My Reviews</a></li>
        {% endif %}
      {% else %}
        <li><a href="/home/" class="block py-3 px-4 rounded-full hover:bg-orange-100 hover:text-orange-600 {% if request.path == '/home/' %}bg-orange-500 text-white{% endif %}">Home</a></li>
        <li><a href="/login/" class="block py-3 bg-[#0C2D57] text-white text-center rounded-lg font-semibold mt-2 hover:bg-[#163970] transition">Log In</a></li>
      {% endif %}
    </ul>
  </div>
</nav>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const mobileNav = document.getElementById('mobile-nav');
    const toggle = document.getElementById('navbar-toggle');
    const closeBtn = document.getElementById('mobile-nav-close');

    function openNav() {
      mobileNav.classList.remove('-translate-y-full', 'opacity-0', 'pointer-events-none');
      mobileNav.classList.add('translate-y-0', 'opacity-100', 'pointer-events-auto');
    }

    function closeNav() {
      mobileNav.classList.add('-translate-y-full', 'opacity-0', 'pointer-events-none');
      mobileNav.classList.remove('translate-y-0', 'opacity-100', 'pointer-events-auto');
    }

    toggle.addEventListener('click', (e) => {
      e.stopPropagation();
      mobileNav.classList.contains('opacity-100') ? closeNav() : openNav();
    });
    closeBtn.addEventListener('click', closeNav);
    window.addEventListener('resize', () => {
      if (window.innerWidth >= 768) closeNav();
    });
  });
</script>
