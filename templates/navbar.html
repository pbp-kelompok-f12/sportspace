{% load static %}
<nav class="w-full sticky top-0 z-50 bg-white/90 backdrop-blur-md shadow-sm border-b border-gray-100 transition-all duration-300">
  <div class="flex items-center justify-between px-4 sm:px-8 py-3">

    <!-- Logo -->
    <div class="flex items-center gap-3 flex-none">
      <img src="{% static 'img/logoonly.png' %}" alt="SportSpace" class="h-8 w-8 rounded-md shadow-sm">
      <a href="/" class="text-[#0C2D57] font-extrabold text-xl tracking-tight hover:text-orange-500 transition">SportSpace</a>
    </div>

    <!-- Menu Desktop -->
    <ul class="hidden lg:flex flex-1 justify-center gap-8 text-[#0C2D57] font-semibold items-center">
      {% if user.is_authenticated %}
        {% if user.profile.role == 'admin' %}
          <li><a href="/dashboard-admin/" class="px-4 py-2 rounded-full hover:bg-orange-100 hover:text-orange-600 transition {% if request.path == '/dashboard-admin/' %}bg-orange-500 text-white shadow-sm{% endif %}">Home</a></li>
          <li><a href="/dashboard-admin/lapangan/" class="px-4 py-2 rounded-full hover:bg-orange-100 hover:text-orange-600 transition {% if '/dashboard-admin/lapangan/' in request.path %}bg-orange-500 text-white shadow-sm{% endif %}">Lapangan</a></li>
          <li><a href="/dashboard-admin/users/" class="px-4 py-2 rounded-full hover:bg-orange-100 hover:text-orange-600 transition {% if '/dashboard-admin/users/' in request.path %}bg-orange-500 text-white shadow-sm{% endif %}">Pengguna</a></li>
          <li><a href="/dashboard-admin/bookings/" class="px-4 py-2 rounded-full hover:bg-orange-100 hover:text-orange-600 transition {% if '/dashboard-admin/bookings/' in request.path %}bg-orange-500 text-white shadow-sm{% endif %}">Booking</a></li>
        {% else %}
          <li><a href="/home/" class="px-4 py-2 rounded-full hover:bg-orange-100 hover:text-orange-600 transition {% if request.path == '/home/' %}bg-orange-500 text-white shadow-sm{% endif %}">Sewa Lapangan</a></li>
          <li><a href="/booking/my-bookings/" class="px-4 py-2 rounded-full hover:bg-orange-100 hover:text-orange-600 transition {% if '/booking/my-bookings/' in request.path %}bg-orange-500 text-white shadow-sm{% endif %}">Booking Saya</a></li>
          <li><a href="/matchmaking/" class="px-4 py-2 rounded-full hover:bg-orange-100 hover:text-orange-600 transition {% if '/matchmaking/' in request.path %}bg-orange-500 text-white shadow-sm{% endif %}">Matchmaking</a></li>
          <li><a href="{% url 'review:my_reviews' %}" class="px-4 py-2 rounded-full hover:bg-orange-100 hover:text-orange-600 transition {% if '/review/my/' in request.path %}bg-orange-500 text-white shadow-sm{% endif %}">My Reviews</a></li>
        {% endif %}
      {% else %}
        <li><a href="/home/" class="px-4 py-2 rounded-full hover:bg-orange-100 hover:text-orange-600 transition {% if request.path == '/home/' %}bg-orange-500 text-white shadow-sm{% endif %}">Home</a></li>
      {% endif %}
    </ul>

    <!-- Profile / Auth -->
    <div class="hidden lg:flex items-center gap-4">
      {% if user.is_authenticated %}
        <a href="/accounts/profile/" class="flex items-center gap-2 hover:bg-[#0C2D57]/10 px-2 py-1 rounded-lg transition">
          {% if user.profile.photo_url %}
            <img src="{{ user.profile.photo_url }}" class="h-8 w-8 rounded-full object-cover border border-[#0C2D57]/20">
          {% else %}
            <img src="{% static 'img/defaultprofile.png' %}" class="h-8 w-8 rounded-full object-cover border border-[#0C2D57]/20">
          {% endif %}
          <span class="font-medium text-[#0C2D57]">{{ user.username }}</span>
        </a>
        <form action="/accounts/logout/" method="post" class="m-0">
          {% csrf_token %}
          <button class="bg-[#0C2D57] hover:bg-[#163970] px-4 py-1.5 text-white font-semibold rounded-lg shadow-sm transition">Log Out</button>
        </form>
      {% else %}
        <a href="/login/" class="bg-[#0C2D57] hover:bg-[#163970] px-4 py-1.5 text-white font-semibold rounded-lg shadow-sm transition">Log In</a>
      {% endif %}
    </div>

    <!-- Mobile Toggle -->
    <button id="navbar-toggle"
            type="button"
            class="lg:hidden text-[#0C2D57] focus:outline-none hover:scale-110 transition"
            aria-label="Open menu">
      <svg class="w-7 h-7" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" d="M4 7h16M4 12h16M4 17h16"/>
      </svg>
    </button>
  </div>

  <!-- MOBILE NAV DROPDOWN -->
  <div id="mobile-nav"
       class="lg:hidden bg-white/95 backdrop-blur-md shadow-md overflow-hidden 
              max-h-0 opacity-0 transition-all duration-500 ease-in-out">
    <ul class="flex flex-col text-base px-6 py-3 text-[#0C2D57] font-semibold">
      {% if user.is_authenticated %}
        {% if user.profile.role == 'admin' %}
          <li><a href="/dashboard-admin/" class="block py-2 px-3 rounded-md hover:bg-orange-100 hover:text-orange-600 transition">Home</a></li>
          <li><a href="/dashboard-admin/lapangan/" class="block py-2 px-3 rounded-md hover:bg-orange-100 hover:text-orange-600 transition">Lapangan</a></li>
          <li><a href="/dashboard-admin/users/" class="block py-2 px-3 rounded-md hover:bg-orange-100 hover:text-orange-600 transition">Pengguna</a></li>
          <li><a href="/dashboard-admin/bookings/" class="block py-2 px-3 rounded-md hover:bg-orange-100 hover:text-orange-600 transition">Booking</a></li>
        {% else %}
          <li><a href="/home/" class="block py-2 px-3 rounded-md hover:bg-orange-100 hover:text-orange-600 transition">Sewa Lapangan</a></li>
          <li><a href="/booking/my-bookings/" class="block py-2 px-3 rounded-md hover:bg-orange-100 hover:text-orange-600 transition">Booking Saya</a></li>
          <li><a href="/matchmaking/" class="block py-2 px-3 rounded-md hover:bg-orange-100 hover:text-orange-600 transition">Matchmaking</a></li>
          <li><a href="{% url 'review:my_reviews' %}" class="block py-2 px-3 rounded-md hover:bg-orange-100 hover:text-orange-600 transition">My Reviews</a></li>
        {% endif %}
        <li class="border-t border-gray-200 mt-2 pt-2">
          <a href="/accounts/profile/" class="flex items-center gap-3 px-3 py-2 rounded-md hover:bg-orange-100 transition">
            {% if user.profile.photo_url %}
              <img src="{{ user.profile.photo_url }}" class="h-8 w-8 rounded-full object-cover border border-[#0C2D57]/20">
            {% else %}
              <img src="{% static 'img/defaultprofile.png' %}" class="h-8 w-8 rounded-full object-cover border border-[#0C2D57]/20">
            {% endif %}
            <span class="font-medium text-[#0C2D57]">{{ user.username }}</span>
          </a>
        </li>
        <li>
          <form action="/accounts/logout/" method="post" class="mt-2">
            {% csrf_token %}
            <button class="w-full bg-[#0C2D57] hover:bg-[#163970] text-white font-semibold rounded-lg py-2 mt-1 transition">Log Out</button>
          </form>
        </li>
      {% else %}
        <li><a href="/home/" class="block py-2 px-3 rounded-md hover:bg-orange-100 hover:text-orange-600 transition">Home</a></li>
        <li><a href="/login/" class="block py-2 bg-[#0C2D57] text-white text-center rounded-lg font-semibold mt-2 hover:bg-[#163970] transition">Log In</a></li>
      {% endif %}
    </ul>
  </div>
</nav>

<script>
document.addEventListener('DOMContentLoaded', function () {
  const mobileNav = document.getElementById('mobile-nav');
  const toggleBtn = document.getElementById('navbar-toggle');

  if (!mobileNav || !toggleBtn) return;

  function openNav() {
    mobileNav.classList.remove('max-h-0', 'opacity-0');
    mobileNav.classList.add('max-h-[600px]', 'opacity-100');
  }

  function closeNav() {
    mobileNav.classList.add('max-h-0', 'opacity-0');
    mobileNav.classList.remove('max-h-[600px]', 'opacity-100');
  }

  toggleBtn.addEventListener('click', (e) => {
    e.stopPropagation();
    const isOpen = mobileNav.classList.contains('opacity-100');
    isOpen ? closeNav() : openNav();
  });

  document.addEventListener('click', (e) => {
    if (!mobileNav.contains(e.target) && !toggleBtn.contains(e.target)) {
      closeNav();
    }
  });

  window.addEventListener('resize', () => {
    if (window.innerWidth >= 1024) closeNav();
  });
});
</script>
